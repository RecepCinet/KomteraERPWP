<?php
 use phpCtrl\C_DataBase; use phpCtrl\C_DataGrid; use phpCtrl\C_Utility; goto p1Gg3; TFcqp: if ($start < 0) { $start = 0; } goto XvRxF; p1Gg3: require_once "\160\x68\x70\x47\x72\x69\144\x2e\160\x68\x70"; goto QXfym; hb2IK: $pos = strpos($sqlWhere, "\101\116\x44\x20"); goto vwbGM; CX3xZ: $grid_sql = $_SESSION[GRID_SESSION_KEY . "\137" . $gridName . "\x5f\x73\x71\x6c"]; goto ZCtj9; mEIpN: $cn = $db_connection; goto Nz3DC; BfrXD: $data_type = isset($_GET["\144\164"]) ? $_GET["\144\164"] : "\152\163\157\156"; goto CX3xZ; R5vGn: if ($pos !== false) { $sqlWhere = substr_replace($sqlWhere, '', $pos, strlen("\x4f\x52\x20")); } goto FA9Yy; FA9Yy: $sqlOrderBy = !$sidx ? '' : "\x20\117\x52\x44\105\x52\x20\x42\x59\40{$sidx}\x20{$sord}"; goto i4sXg; xG1OK: $start = $limit * $page - $limit; goto TFcqp; Ir36a: $sidx = $_GET["\x73\151\x64\x78"]; goto OdKfF; Nz3DC: if (empty($cn)) { $db = new C_DataBase(PHPGRID_DB_HOSTNAME, PHPGRID_DB_USERNAME, PHPGRID_DB_PASSWORD, PHPGRID_DB_NAME, PHPGRID_DB_TYPE, PHPGRID_DB_CHARSET); } else { $db = new C_DataBase($cn["\150\157\163\164\156\141\x6d\x65"], $cn["\165\x73\145\x72\x6e\x61\155\145"], $cn["\x70\x61\x73\x73\x77\157\162\144"], $cn["\144\x62\156\x61\155\145"], $cn["\x64\142\x74\171\160\x65"], $cn["\x64\x62\x63\150\141\x72\x73\x65\164"]); } goto Wq0cp; ZCtj9: $sql_key = unserialize($_SESSION[GRID_SESSION_KEY . "\x5f" . $gridName . "\137\x73\161\x6c\137\x6b\145\171"]); goto DmVjJ; DlgUB: if ($count > 0 && $limit > 0) { $total_pages = ceil($count / $limit); } else { $total_pages = 0; } goto NFZ2J; H6vOc: $rs = $db->select_limit($grid_sql, 1, 0); goto qKpRr; WgtMu: $pos = strpos($sqlWhere, "\x4f\122\40"); goto R5vGn; qKpRr: $sqlWhere = ''; goto MYloG; JeG09: switch ($data_type) { case "\170\x6d\x6c": $data = "\x3c\77\170\155\154\x20\166\145\x72\163\x69\157\156\75\47\61\56\60\x27\x20\145\156\x63\157\144\151\156\147\75\x27\x75\164\x66\55\x38\x27\x3f\x3e"; $data .= "\74\x72\x6f\167\163\x3e"; $data .= "\x3c\160\x61\x67\x65\x3e" . $page . "\74\x2f\160\x61\147\145\x3e"; $data .= "\x3c\164\x6f\x74\x61\154\76" . $total_pages . "\74\x2f\x74\x6f\x74\141\x6c\x3e"; $data .= "\x3c\162\x65\x63\157\162\x64\x73\x3e" . $count . "\x3c\x2f\x72\145\x63\157\x72\x64\163\76"; while ($row = $db->fetch_array_assoc($result)) { $data .= "\x3c\x72\157\167\40\151\x64\75\47" . gen_rowids($row, $sql_key) . "\47\76"; for ($i = 0; $i < $db->num_fields($result); $i++) { $col_name = $db->field_name($result, $i); $data .= "\x3c\143\x65\x6c\x6c\x3e" . $row[$col_name] . "\x3c\x2f\x63\145\154\x6c\x3e"; } $data .= "\x3c\57\162\157\x77\x3e"; } $data .= "\74\x2f\162\157\167\x73\x3e"; header("\103\157\x6e\x74\145\x6e\x74\x2d\164\171\x70\145\x3a\x20\164\x65\x78\164\57\170\x6d\x6c\73\143\150\141\162\x73\145\x74\x3d\x75\164\146\x2d\70"); echo $data; break; case "\x6a\163\x6f\156": $response = new stdClass(); $response->page = $page; $response->total = $total_pages; $response->records = $count; $i = 0; $data = array(); while ($row = $db->fetch_array_assoc($result)) { unset($data); $response->rows[$i]["\x69\144"] = C_Utility::gen_rowids($row, $sql_key); for ($j = 0; $j < $db->num_fields($result); $j++) { $col_name = $db->field_name($result, $j); $data[] = $row[$col_name]; } $response->rows[$i]["\143\x65\x6c\x6c"] = $data; $data = array(); $i++; } echo json_encode($response); break; } goto huPF8; vwbGM: if ($pos !== false) { $sqlWhere = substr_replace($sqlWhere, '', $pos, strlen("\x41\x4e\x44\x20")); } goto WgtMu; XvRxF: $db->db->SetFetchMode(ADODB_FETCH_BOTH); goto H321v; H321v: $result = $db->select_limit($SQL, $limit, $start); goto yexfc; Wq0cp: $page = $_GET["\160\141\147\x65"]; goto mA22R; NFZ2J: if ($page > $total_pages) { $page = $total_pages; } goto JeG09; mA22R: $limit = $_GET["\x72\157\x77\x73"]; goto Ir36a; BABER: $sql_table = $_SESSION[GRID_SESSION_KEY . "\137" . $gridName . "\137\x73\161\154\x5f\x74\141\x62\154\145"]; goto Zt1c1; QXfym: if (!session_id()) { session_start(); } goto IwGmq; MYloG: $searchOn = isset($_REQUEST["\137\163\145\x61\162\x63\x68"]) && $_REQUEST["\x5f\x73\145\141\x72\x63\150"] == "\x74\x72\165\x65" ? true : false; goto Y1IRI; OdKfF: $sord = $_GET["\163\157\162\x64"]; goto H6vOc; DmVjJ: $sql_fkey = $_SESSION[GRID_SESSION_KEY . "\x5f" . $gridName . "\x5f\163\x71\x6c\137\146\x6b\145\171"]; goto BABER; yexfc: $count = $db->num_rows($db->db_query($SQL)); goto DlgUB; IwGmq: $gridName = isset($_GET["\x67\x6e"]) ? $_GET["\x67\156"] : die("\x50\110\x50\107\x52\x49\x44\137\x45\x52\122\117\x52\72\x20\x55\114\122\x20\x70\x61\x72\141\x6d\145\x74\145\x72\x20\42\x67\x6e\42\40\x69\x73\40\x6e\x6f\164\x20\144\145\146\x69\x6e\x65\144\56"); goto BfrXD; riBup: $db_connection = unserialize($_SESSION[GRID_SESSION_KEY . "\x5f" . $gridName . "\137\x64\142\137\x63\157\x6e\156\x65\x63\x74\151\x6f\x6e"]); goto mEIpN; Y1IRI: if ($searchOn) { $col_dbnames = array(); $col_dbnames = $db->get_col_dbnames($rs); foreach ($_REQUEST as $key => $value) { if (in_array($key, $col_dbnames)) { $fm_type = $db->field_metatype($rs, $db->field_index($rs, $key)); switch ($fm_type) { case "\111": case "\x4e": case "\x52": case "\123\x45\x52\x49\101\x4c": case "\114": $sqlWhere .= "\40\x41\116\104\40" . $key . "\40\x3d\40" . $value; break; default: $sqlWhere .= "\x20\101\x4e\104\x20" . $key . "\40\114\111\113\x45\x20\x27" . $value . "\x25\x27"; break; } } } if (isset($_REQUEST["\x66\151\x6c\x74\145\x72\x73"]) && $_REQUEST["\146\151\x6c\164\x65\x72\x73"] != '') { $op = array("\145\x71" => "\40\x3d\47\45\163\x27\x20", "\156\x65" => "\40\x21\x3d\x27\45\x73\47\40", "\x6c\x74" => "\40\74\40\45\163\40", "\x6c\145" => "\x20\x3c\x3d\40\x25\x73\40", "\147\164" => "\40\x3e\x20\x25\163\40", "\x67\x65" => "\x20\76\x3d\40\45\163\x20", "\x62\x77" => "\x20\154\x69\153\x65\x20\47\45\163\45\45\47\x20", "\x62\x6e" => "\x20\156\157\x74\40\x6c\x69\153\145\x20\47\x25\x73\45\45\47\40", "\x69\156" => "\40\x69\156\x20\50\x25\x73\51\40", "\156\x69" => "\x20\x6e\157\x74\40\x69\x6e\x20\50\x25\163\x29\x20", "\145\167" => "\x20\154\x69\x6b\x65\x20\x27\x25\45\x25\163\x27\40", "\x65\156" => "\40\x6e\157\164\40\x6c\x69\153\145\x20\x27\45\x25\45\x73\47\x20", "\143\156" => "\x20\x6c\x69\153\x65\x20\47\x25\x25\x25\x73\45\x25\47\40", "\x6e\143" => "\40\x6e\157\x74\x20\x6c\151\x6b\x65\40\47\x25\45\45\x73\45\x25\x27\40"); $filters = json_decode(stripcslashes($_REQUEST["\x66\x69\154\x74\145\162\163"])); $groupOp = $filters->groupOp; $rules = $filters->rules; for ($i = 0; $i < count($rules); $i++) { $sqlWhere .= $groupOp . "\x20" . $rules[$i]->field . sprintf($op[$rules[$i]->op], $rules[$i]->data); } } } goto hb2IK; i4sXg: if ($sql_filter != '' && $searchOn) { $SQL = $grid_sql . "\x20\127\110\x45\122\x45\x20" . $sql_filter . "\x20\x41\x4e\x44\40" . $sqlWhere . $sqlOrderBy; } elseif ($sql_filter != '' && !$searchOn) { $SQL = $grid_sql . "\x20\x57\110\x45\122\105\40" . $sql_filter . $sqlOrderBy; } elseif ($sql_filter == '' && $searchOn) { $SQL = $grid_sql . "\40\x57\x48\105\122\105\40" . $sqlWhere . $sqlOrderBy; } else { $SQL = $grid_sql . $sqlOrderBy; } goto xG1OK; Zt1c1: $sql_filter = $_SESSION[GRID_SESSION_KEY . "\137" . $gridName . "\x5f\163\x71\x6c\x5f\x66\151\154\x74\x65\162"]; goto riBup; huPF8: $db = null;